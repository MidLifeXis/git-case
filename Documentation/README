# About

Please note that this file uses Markdown notation.
 * [markdown syntax for vim](http://www.vim.org/scripts/script.php?script_id=1242)
 * [markdown basics](http://daringfireball.net/projects/markdown/basics)

# Implementation

## General

Few points about implementation...

 * code uses .git/case/tmp-$$/index for temporary index
 * code uses .git/case/active for current case
 * code uses 'cases' branch to create history for cases
 * there are no other temporary files created (anymore)

## Datastore

In the 'cases' branch, git-case stores each case in it's own directory.
The directory contains all information about the case.  Each change to
the case creates a new commit on the 'cases' branch.

    <id>/               # directory per case
    |-- description     # 1st line title, then free form description
    |-- type            # bug/feature/question/...
    |-- found           # git commit worktree was in when case created RO
    |-- state           # new/open/invalid/etc
    |-- assigned        # name <email>
    |-- marks/          # list of marks - tags in most tracker talk
    |   `-- <name>      # empty file
    |-- comments/       # comments, one per file
    |   `-- <sha1>      # contains arbitrary text
    |-- files/          # attachements to the case/comment
    |   `-- <filename>/ # the name of the dir is actually the name of the file
    |       `-- <sha1>  # hash of the file, contais the file
    |-- ids/            # commits for which the state of thsi bug is known
    |   `-- <sha1>      # file contains either 'good' or 'bad'
    `-- fields/         # additional fields
        `-- <name>      # contains one line of text

There is a bit more information on the wiki page, see below.

# Completed commands

## creating new cases

    # ./git-case-new this is the first bug
    # ./git-case-new this is the second bug
    # ./git-case-new this is the third bug

    # git log --pretty=oneline --abbrev-commit cases
    5d67789... this is the third bug
    2785704... this is the second bug
    3e75d93... this is the first bug

## listing cases

    # ./git-case-list
    c11bce     [new]  this is the third bug
    cb2193     [new]  this is the first bug
    d5f5e8     [new]  this is the second bug

## activating a case

    # ./git-case-active c11bce
    # ./git-case-active
    c11bcecc97b0cd1a7e5bc420890b6b20c7fe2132

## commenting

    # ./git-case-comment some text goes here

## attaching a file while commenting

    # ./git-case-attach file-name some text to describe it

## displaying a case

    # ./git-case-show
    Case ID:     c11bce (c11bcecc97b0cd1a7e5bc420890b6b20c7fe2132)
    Description: this is the third bug
    Type:        bug
    State:       new
    Found in:    91ec508... remove the prefix to git-case-active query

    Comments...
      20080413-205926.668903871
        some text goes here

      20080413-205939.925596271
        some text to describe it
        
        Attachment: file-name 16b14f5da9e2fcd6f3f38cc9e584cef2f3c90ebe

## setting and clearing marks

    # ./git-case-mark fixme
    # ./git-case-mark -d fixme

## setting and clearing custom fields

    # ./git-case-field variable value
    # ./git-case-field variable
    value
    # ./git-case-field -d variable

## changing state

    # ./git-case-state
    new
    # ./git-case-state old
    # ./git-case-state
    old

## adding good/bad ids

    # ./git-case-ids -g HEAD
    # ./git-case-ids -b HEAD~1
    # ./git-case-ids -l
    good 12799ccbe7ce445b11b7bd4833bcc2c2ce1b48b7
    bad  67be85f1274474029aad8a75b823592324305aa4
    # ./git-case-ids -d HEAD
    # ./git-case-ids -l
    bad  67be85f1274474029aad8a75b823592324305aa4

# References:

  Wiki:        http://www.jukie.net/~bart/kwiki/index.cgi?GitBugTracker
  Git via ssh: tachyon.jukie.net:/home/git/git-case.git
  Public git:  git://tachyon.jukie.net/git-case.git


vim: set ts=8 et sw=8 tw=72 ft=mkd
